<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <title>Automating Semantic Sprites with Compass by Jeff Zych</title>
    <meta content='width=device-width, initial-scale=1.0, user-scalable=yes' name='viewport'>
    <meta content='black' name='apple-mobile-web-app-status-bar-style'>
    <meta content='yes' name='apple-mobile-web-app-capable'>
    <meta content="In my previous post, I explained how to use image sprites semantically. But as with all image spriting, setting each sprite's size and position is a pain. Compass can automate this, but it's designed with the assumption that all your sprites will be background images of elements." name='description'>
    <meta content='Jeff Zych' name='author'>
    <!-- FB Open Graph meta tags -->
    <meta content='blog' property='og:type'>
    <meta content="Jeff Zych's Corner of the Internet" property='og:site_name'>
    <meta content='Automating Semantic Sprites with Compass by Jeff Zych' property='og:title'>
    <meta content="In my previous post, I explained how to use image sprites semantically. But as with all image spriting, setting each sprite's size and position is a pain. Compass can automate this, but it's designed with the assumption that all your sprites will be background images of elements." property='og:description'>
    <meta content='http://jlzych.com/images/monogram.png' property='og:image'>
    <meta content='http://jlzych.com/2013/09/01/automating-semantic-sprites-with-compass/' property='og:url'>
    <!-- Additional Twitter tags - additive with og: tags -->
    <meta content='summary_large_image' name='twitter:card'>
    <meta name='twitter:creator' value='@jlzych'>
    <link href="/favicon.ico?v=2" rel="icon" type="image/ico?v=2" />
    <link href='/favicon.png' rel='icon' type='image/png'>
    <link href='touch-icon-iphone.png' rel='apple-touch-icon'>
    <script src='//cdn.optimizely.com/js/1111070510.js'></script>
    <link href="/stylesheets/application.css?1552878862" media="screen" rel="stylesheet" type="text/css" />
    <link href='/feed.xml' rel='alternate' title='RSS for Jeff Zych' type='application/rss+xml'>
    <script src='//use.typekit.net/kbr8kzk.js' type='text/javascript'></script>
    <script>
      try{Typekit.load();}catch(e){}
    </script>
  </head>
  <body>
    <div class='container'>
      <div id='main' role='main'>
        <header>
          <h1 class='monogram'>
                <a title="Home" href="/"><img alt="JZ" src="/images/monogram.svg?1522103966" />
            Jeff Zych
            </a>
        
          </h1>
          <nav class='nav-main'>
            <ul>
              <li><a title="About Jeff Zych" href="/about">About Me</a></li>
              <li><a href="/archives">Archives</a></li>
            </ul>
          </nav>
        </header>
        <div class='content'>
          <article>
            <time class='article__date' datetime='2013-09-01'>
              <i>Posted on</i>
              Sep  1, 2013
              <i>by</i>
              Jeff Zych
            </time>
            <h1 class='article__title'><a href="/2013/09/01/automating-semantic-sprites-with-compass/">Automating Semantic Sprites with Compass</a></h1>
            <p>In my <a href="http://jlzych.com/2013/08/26/a-more-semantic-approach-to-spriting-images/">previous post</a>, I explained how to use image sprites semantically. But as with all image spriting, setting each sprite&rsquo;s size and position is a pain. <a href="http://compass-style.org">Compass</a> can automate this, but it&rsquo;s designed with the assumption that all your sprites will be background images of elements. Even so, Compass provides a number of under-documented functions that can help automate my technique.</p>
            
            <h2 id="refresher">Refresher</h2>
            
            <p>First, a quick summary of my <a href="http://jlzych.com/2013/08/26/a-more-semantic-approach-to-spriting-images/">previous post</a>. The <a href="http://css-tricks.com/css-sprites/">standard way to sprite images</a> is to set the sprite sheet as the <code>background-image</code> of an element, and set its <code>background-position</code> to the coordinates of the image you want to display. But if your image is part of the content, then semantically it should be in the markup as an <code>img</code> tag. To accomplish this, set the <code>img</code> tag&rsquo;s <code>src</code> to the sprite sheet, and use a container element as a &ldquo;window&rdquo; to let one sprite show through at a time. For the specifics of how to do this, <a href="http://jlzych.com/2013/08/26/a-more-semantic-approach-to-spriting-images/">read my post</a>.</p>
            
            <h2 id="automate-this-with-compass">Automate this with Compass</h2>
            
            <p>As I mentioned, the most difficult part of spriting is setting the image size and position for each sprite. Luckily, Compass can help us, but their <a href="http://compass-style.org/help/tutorials/spriting/">spriting documentation</a> is geared towards the standard technique, and thus doesn&rsquo;t provide much help to accomplish my method. But fear not! Compass can still help us.</p>
            
            <h3 id="create-the-sprite-sheet">Create the sprite sheet</h3>
            
            <p>The first step to doing any spriting in Compass is to <code>@import</code> a folder of images. Compass will generate a sprite sheet image, and create a number of variables that we can use to get the size and position of each sprite.</p>
            <pre class="highlight scss"><span class="k">@import</span> <span class="s2">&quot;sprites/*.png&quot;</span><span class="p">;</span></pre>
            <h3 id="sprite-dimensions">Sprite Dimensions</h3>
            
            <p>Next, we need to get the dimensions of each sprite, and set the container element to that size. Compass provides a <code>sprite-dimensions</code> function, which takes 2 parameters: the sprite map Compass generated, and the name of the sprite (i.e. the filename, sans extension). Then it outputs the <code>width</code> and <code>height</code> of the sprite. If you have no idea what you&rsquo;re supposed to pass as the sprite map parameter, you&rsquo;re not alone. After <a href="https://github.com/chriseppstein/compass/blob/stable/lib/compass/sprite_importer/content.erb#L16">some digging</a>, I discovered Compass assigns the sprite map to a variable named <code>$&lt;folder&gt;-sprites</code>. In this example, that makes the variable the awkwardly named <code>$sprites-sprites</code>.</p>
            <pre class="highlight scss"><span class="k">@include</span> <span class="nd">sprite-dimensions</span><span class="p">(</span><span class="nv">$sprites-sprites</span><span class="o">,</span> <span class="s2">&quot;my-sprite&quot;</span><span class="p">);</span></pre>
            <h3 id="sprite-position">Sprite Position</h3>
            
            <p>The next step is to set the <code>top</code> and <code>left</code> properties of the image tag. Once again, Compass provides us a helper function: the aptly named <code>sprite-position</code>. Like <code>sprite-dimensions</code>, it also takes the sprite map and sprite name as parameters. But unlike <code>sprite-dimensions</code>, it provides us the <code>left</code> and <code>top</code> properties concatenated in a string, e.g. &ldquo;20px 120px&rdquo;. This seems weird and inconsistent at first, until you realize it&rsquo;s designed to be used as the value of the <code>background-position</code> property. To help us access each value individually, SASS has a function named <code>nth</code>, which returns the value at the position you pass it (starting from 1). And don&rsquo;t worry about converting that string to an array &mdash; SASS will automatically convert strings to arrays, splitting the string on spaces. So that gives us:</p>
            <pre class="highlight scss"><span class="nc">.my-sprite</span> <span class="nt">img</span> <span class="p">{</span>&#x000A;  <span class="nv">$position</span><span class="p">:</span> <span class="nf">sprite-position</span><span class="p">(</span><span class="nv">$sprites-sprites</span><span class="o">,</span> <span class="s2">&quot;my-sprite&quot;</span><span class="p">);</span>&#x000A;  <span class="nl">left</span><span class="p">:</span> <span class="nf">nth</span><span class="p">(</span><span class="nv">$position</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>&#x000A;  <span class="nl">top</span><span class="p">:</span> <span class="nf">nth</span><span class="p">(</span><span class="nv">$position</span><span class="o">,</span> <span class="m">2</span><span class="p">);</span>&#x000A;<span class="p">}</span></pre>
            <h3 id="putting-it-all-together">Putting it All Together</h3>
            
            <p>So now we have all the pieces in place to position each individual sprite, and all we need is the name of each image. For example:</p>
            <pre class="highlight scss"><span class="k">@import</span> <span class="s2">&quot;sprites/*.png&quot;</span><span class="p">;</span>&#x000A;&#x000A;<span class="nc">.sprite-container</span> <span class="p">{</span>&#x000A;  <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span> <span class="c1">// or inline-block&#x000A;</span>  <span class="nl">overflow</span><span class="p">:</span> <span class="nb">hidden</span><span class="p">;</span>&#x000A;  <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>&#x000A;&#x000A;  <span class="k">&amp;</span><span class="nc">.my-sprite</span> <span class="p">{</span>&#x000A;    <span class="k">@include</span> <span class="nd">sprite-dimensions</span><span class="p">(</span><span class="nv">$sprites-sprites</span><span class="o">,</span> <span class="s2">&quot;my-sprite&quot;</span><span class="p">);</span>&#x000A;&#x000A;    <span class="nt">img</span> <span class="p">{</span>&#x000A;      <span class="nv">$position</span><span class="p">:</span> <span class="nf">sprite-position</span><span class="p">(</span><span class="nv">$sprites-sprites</span><span class="o">,</span> <span class="s2">&quot;my-sprite&quot;</span><span class="p">);</span>&#x000A;      <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>&#x000A;      <span class="nl">left</span><span class="p">:</span> <span class="nf">nth</span><span class="p">(</span><span class="nv">$position</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>&#x000A;      <span class="nl">top</span><span class="p">:</span> <span class="nf">nth</span><span class="p">(</span><span class="nv">$position</span><span class="o">,</span> <span class="m">2</span><span class="p">);</span>&#x000A;    <span class="p">}</span>&#x000A;  <span class="p">}</span>&#x000A;&#x000A;  <span class="c1">// ...etc. for each sprite&#x000A;</span><span class="p">}</span></pre>
            <p>The obvious flaw here is that you need to write code for each sprite in the sprite sheet. Luckily for us, Compass has one more trick up its sleeve to help automate this: the <a href="https://github.com/chriseppstein/compass/blob/stable/lib/compass/sass_extensions/functions/sprites.rb#L14"><code>sprite_names</code></a> function. Pass it a sprite map, and it outputs a list of sprite names. Then we can use <code>@each</code> to loop through the list, and generate the size and position of each. Bringing it all together, our code looks like this:</p>
            <pre class="highlight scss"><span class="k">@import</span> <span class="s2">&quot;sprites/*.png&quot;</span><span class="p">;</span>&#x000A;<span class="nv">$sprite-names</span><span class="p">:</span> <span class="nf">sprite_names</span><span class="p">(</span><span class="nv">$sprites-sprites</span><span class="p">);</span>&#x000A;&#x000A;<span class="nc">.sprite-container</span> <span class="p">{</span>&#x000A;  <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span> <span class="c1">// or inline-block&#x000A;</span>  <span class="nl">overflow</span><span class="p">:</span> <span class="nb">hidden</span><span class="p">;</span>&#x000A;  <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>&#x000A;&#x000A;  <span class="k">@each</span> <span class="err">$</span><span class="nt">sprite</span> <span class="nt">in</span> <span class="err">$</span><span class="nt">sprite-names</span> <span class="p">{</span>&#x000A;    <span class="k">&amp;</span><span class="nc">.sprite-</span><span class="si">#{</span><span class="nv">$sprite</span><span class="si">}</span> <span class="p">{</span>&#x000A;      <span class="k">@include</span> <span class="nd">sprite-dimensions</span><span class="p">(</span><span class="nv">$sprites-sprites</span><span class="o">,</span> <span class="nv">$sprite</span><span class="p">);</span>&#x000A;&#x000A;      <span class="nt">img</span> <span class="p">{</span>&#x000A;        <span class="nv">$position</span><span class="p">:</span> <span class="nf">sprite-position</span><span class="p">(</span><span class="nv">$sprites-sprites</span><span class="o">,</span> <span class="nv">$sprite</span><span class="p">);</span>&#x000A;        <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>&#x000A;        <span class="nl">left</span><span class="p">:</span> <span class="nf">nth</span><span class="p">(</span><span class="nv">$position</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>&#x000A;        <span class="nl">top</span><span class="p">:</span> <span class="nf">nth</span><span class="p">(</span><span class="nv">$position</span><span class="o">,</span> <span class="m">2</span><span class="p">);</span>&#x000A;      <span class="p">}</span>&#x000A;    <span class="p">}</span>&#x000A;  <span class="p">}</span> <span class="c1">// @each&#x000A;</span><span class="p">}</span> <span class="c1">// .sprite-container&#x000A;</span></pre>
            <h2 id="conclusion">Conclusion</h2>
            
            <p>Whew, that was a whirlwind of Compass code. But once you get it all set up, it works quite well. You can add and remove sprites as you please, without needing to update a single line of SCSS. Happy spriting!</p>
            <footer class='article__footer'>
              Thoughts? Reply
              <a href="https://twitter.com/intent/tweet?screen_name=jlzych">@jlzych</a>
            </footer>
          </article>
          <div class='article-links'>
            <div>
              <span class='article-link-label text-uppercase text-small'>Previous article:</span>
              <a href="/2013/08/26/a-more-semantic-approach-to-spriting-images/">&laquo; A More Semantic Approach to Spriting Images</a>
            </div>
            <div>
              <span class='article-link-label text-uppercase text-small'>Next article:</span>
              <a href="/2013/09/09/the-importance-of-good-defaults/">The Importance of Good Defaults &raquo;</a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer id='site-footer'>
      <p>
        &copy; 2010&ndash;2019 Jeff Zych
        &bull; Hand-crafted with
        <a href="http://middlemanapp.com/">Middleman</a>
      </p>
      <a style="display: none;" href="http://plus.google.com/+JeffZych?rel=author">Google+ profile</a>
    </footer>
    <!-- Google Analytics tracking -->
    <script>
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-21389659-1']);
      _gaq.push(['_trackPageview']);
      
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>

